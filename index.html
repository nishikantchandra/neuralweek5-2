<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>TFJS GRU Multi-stock Binary Predictor (GitHub Pages)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- TF.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.13.0/dist/tf.min.js"></script>
  <!-- PapaParse for CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 16px; max-width:1200px; }
    header { margin-bottom: 12px; }
    .controls { display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-bottom:12px; }
    .section { border:1px solid #ddd; padding:12px; border-radius:8px; margin-bottom:12px; }
    .progress { width:100%; height:18px; background:#eee; border-radius:6px; overflow:hidden; }
    .progress > div { height:100%; background:#4caf50; width:0%; transition:width 0.2s;}
    .timeline-row { display:flex; gap:8px; align-items:center; margin-bottom:6px; }
    .timeline-row canvas { width:100%; height:40px; }
    .charts-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .small { font-size:0.9rem; color:#444; }
    button { padding:8px 12px; }
    input[type=file] { padding:4px; }
    .log { max-height:160px; overflow:auto; background:#111; color:#0f0; padding:8px; font-family:monospace; font-size:12px; border-radius:6px; }
    .meta { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
  </style>
</head>
<body>
  <header>
    <h1>Browser GRU Multi-Stock Binary Predictor (TF.js)</h1>
    <p class="small">Drop a CSV file with columns: Date, Symbol, Open, Close (daily) for 10 S&P500 symbols. Everything runs client-side.</p>
  </header>

  <div class="section">
    <div class="controls">
      <label>
        CSV file:
        <input id="file-input" type="file" accept=".csv" />
      </label>
      <label>
        Train/Test split (chronological % for train):
        <input id="train-split" type="number" min="0" max="100" value="80" style="width:64px;" />
      </label>
      <label>
        Epochs:
        <input id="epochs" type="number" min="1" max="1000" value="30" style="width:64px;" />
      </label>
      <label>
        Batch size:
        <input id="batch-size" type="number" min="1" max="1024" value="32" style="width:64px;" />
      </label>
      <button id="prepare-btn">Prepare Data</button>
      <button id="train-btn" disabled>Train Model</button>
      <button id="predict-btn" disabled>Evaluate/Predict</button>
      <button id="save-btn" disabled>Save Weights (localstorage)</button>
      <button id="load-btn">Load Weights (if exists)</button>
    </div>

    <div class="meta">
      <div>Samples: <span id="samples-meta">-</span></div>
      <div>Symbols: <span id="symbols-meta">-</span></div>
      <div id="warning" style="color:darkred;"></div>
    </div>

    <div style="margin-top:8px;">
      <div class="progress" aria-hidden="true"><div id="progress-bar"></div></div>
      <div id="progress-text" class="small" style="margin-top:6px;">Idle</div>
    </div>
  </div>

  <div class="section charts-grid">
    <div>
      <h3>Sorted Accuracy (per stock)</h3>
      <canvas id="accuracy-bar" height="240"></canvas>
    </div>
    <div>
      <h3>Selected Stock Prediction Timeline</h3>
      <label>
        Stock:
        <select id="stock-select"></select>
      </label>
      <canvas id="stock-timeline" height="240"></canvas>
      <div class="small" id="stock-stats"></div>
    </div>
  </div>

  <div class="section">
    <h3>All Stocks Timelines (correct:green, wrong:red)</h3>
    <div id="timelines-container"></div>
  </div>

  <div class="section">
    <h3>Console / Log</h3>
    <div id="log" class="log"></div>
  </div>

  <script type="module" src="./app.js"></script>
</body>
</html>
